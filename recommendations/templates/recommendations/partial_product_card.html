<div class="bg-white rounded-xl shadow p-3 flex gap-3">
    <div class="w-28 h-28 flex-shrink-0 overflow-hidden rounded-md bg-gray-100">
        {% with img=product.image_links.0 %}
            {% if img %}
                <img src="{{ img }}" alt="{{ product.title }}" class="w-full h-full object-cover">
            {% else %}
                <div class="flex items-center justify-center h-full text-gray-400">No Image</div>
            {% endif %}
        {% endwith %}
    </div>

    <div class="flex-1">
        <div class="flex items-start justify-between">
            <div class="space-y-1">
                <h3 class="text-sm md:text-lg font-semibold text-gray-800">{{ product.title }}</h3>
                {% if product.brand %}
                    <div class="text-xs text-gray-600">Brand: {{ product.brand }}</div>
                {% endif %}
                {% if product.price %}
                    <div class="text-sm font-bold text-green-700">${{ product.price }}</div>
                {% endif %}
            </div>
        </div>

        {% if product.categories %}
            <div class="mt-2 text-xs text-gray-600">
                Categories: {{ product.categories|join:", " }}
            </div>
        {% endif %}

        <div class="mt-3 text-sm text-gray-700">
            {% if product.generated_description %}
                <div>{{ product.generated_description }}</div>
            {% else %}
                <button
                        class="px-3 py-1 bg-teal-500 text-white text-sm rounded hover:bg-teal-600"
                        hx-get="{% url 'recommendations:generate_product_description' product.unique_id %}"
                        hx-swap="outerHTML"
                        hx-target="closest div.bg-white"
                        hx-indicator="#indicator-{{ product.unique_id }}"
                >
                    Generate Description
                </button>

                <div id="indicator-{{ product.unique_id }}" class="htmx-indicator">
                    <p class="mt-2 text-gray-600">Loading...</p>
                </div>
            {% endif %}
        </div>

        <div class="mt-3 text-xs text-gray-500">
            {% if product.material %}Material: {{ product.material }}{% endif %}
            {% if product.manufacturer %} â€¢ Manufacturer: {{ product.manufacturer }}{% endif %}
        </div>
    </div>
</div>
